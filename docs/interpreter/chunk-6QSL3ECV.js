import{a as c}from"./chunk-DSGGCMS6.js";var p="^(entry|activity|exit)\\s*/\\s*([^\\n$]*)(\\n|$)",h=new RegExp(p);function y(t,e){return t.includes(e)}var d=[{re:/initial/,stateType:"initial"},{re:/final/,stateType:"final"},{re:/parallel/,stateType:"parallel"},{re:/(deep.*history)|(history.*deep)/,stateType:"deephistory"},{re:/history/,stateType:"history"},{re:/^\^.*/,stateType:"choice"},{re:/^].*/,stateType:"forkjoin"}];function E(t){return e=>e.re.test(t)}function l(t){return(d.find(E(t))||{stateType:"regular"}).stateType}function a(t){return{name:t,type:l(t)}}function f(t){return!!t.statemachine}function u(t){let e=t?.states??[];return e.filter(f).reduce((n,s)=>n.concat(u(s.statemachine)),e.map(({name:n})=>n))}function g(t,e){e=e??u(t),t.states=t?.states??[];let n=t?.transitions??[];for(let s of t.states.filter(f))s.statemachine.states=g(s.statemachine,e);for(let s of n)y(e,s.from)||(e.push(s.from),t.states.push(a(s.from))),y(e,s.to)||(e.push(s.to),t.states.push(a(s.to)));return t.states}function x(t,e){let n="junction";return t<=1&&e>1&&(n="fork"),t>1&&e<=1&&(n="join"),n}function m(t,e=new c(t)){return t.states=t.states.map(n=>{if(n.type==="forkjoin"&&!n.typeExplicitlySet){let s=e.findTransitionsByTo(n.name).length,i=e.findTransitionsByFrom(n.name).length;n.type=x(s,i)}return n.statemachine&&(n.statemachine=m(n.statemachine,e)),n}),t}function I(t,e){return t.name===e.name}function R(t,e){return t.reduce((n,s)=>{let i=n.findIndex(r=>e(r,s));return i>-1?(n[i]=s,n):n.concat(s)},[])}function b(t){let e=/([^[/]+)?(\[[^\]]+\])?[^/]*(\/.+)?/,n={},s=e.exec(t),i=1,r=2,o=3;return s[i]&&(n.event=s[i].trim()),s[r]&&(n.cond=s[r].slice(1,-1).trim()),s[o]&&(n.action=s[o].slice(1,s[o].length).trim()),n}function T(t,e,n,s=Boolean){s(n)&&(t[e]=n)}function S(t,e,n){T(t,e,n,s=>s&&s.length>0)}function A(t){let e=h.exec(t),n=1,s=2;return e?{type:e[n],body:e[s]}:{type:"activity",body:t}}function j(t){return t.split(/\n\s*/g).map(e=>e.trim()).map(A)}var _={initState:a,extractUndeclaredStates:g,classifyForkJoins:m,getStateType:l,stateEqual:I,uniq:R,parseTransitionExpression:b,extractActions:j,setIf:T,setIfNotEmpty:S};export{_ as a};
//# sourceMappingURL=chunk-6QSL3ECV.js.map
