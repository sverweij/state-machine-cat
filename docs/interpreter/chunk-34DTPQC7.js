import{a}from"./chunk-DSGGCMS6.js";var u="^(entry|activity|exit)\\s*/\\s*([^\\n$]*)(\\n|$)",p=new RegExp(u);function c(t,e){return t.includes(e)}var g=[{re:/initial/,stateType:"initial"},{re:/final/,stateType:"final"},{re:/parallel/,stateType:"parallel"},{re:/(deep.*history)|(history.*deep)/,stateType:"deephistory"},{re:/history/,stateType:"history"},{re:/^\^.*/,stateType:"choice"},{re:/^].*/,stateType:"forkjoin"}];function m(t){return e=>e.re.test(t)}function T(t){return(g.find(m(t))||{stateType:"regular"}).stateType}function y(t){return{name:t,type:T(t)}}function l(t){return!!t.statemachine}function f(t){let e=t?.states??[];return e.filter(l).reduce((n,r)=>n.concat(f(r.statemachine)),e.map(({name:n})=>n))}function x(t,e){e=e??f(t),t.states=t?.states??[];let n=t?.transitions??[];for(let r of t.states.filter(l))r.statemachine.states=x(r.statemachine,e);for(let r of n)c(e,r.from)||(e.push(r.from),t.states.push(y(r.from))),c(e,r.to)||(e.push(r.to),t.states.push(y(r.to)));return t.states}function h(t,e){let n="junction";return t<=1&&e>1&&(n="fork"),t>1&&e<=1&&(n="join"),n}function d(t,e=new a(t)){return t.states=t.states.map(n=>{if(n.type==="forkjoin"&&!n.typeExplicitlySet){let r=e.findTransitionsByTo(n.name).length,s=e.findTransitionsByFrom(n.name).length;n.type=h(r,s)}return n.statemachine&&(n.statemachine=d(n.statemachine,e)),n}),t}function b(t,e){return t.name===e.name}function S(t,e){return t.reduce((n,r)=>{let s=n.findIndex(i=>e(i,r));return s>-1?(n[s]=r,n):n.concat(r)},[])}function A(t){let e=/([^[/]+)?(\[[^\]]+\])?[^/]*(\/.+)?/,n={},r=e.exec(t),s=1,i=2,o=3;return r[s]&&(n.event=r[s].trim()),r[i]&&(n.cond=r[i].slice(1,-1).trim()),r[o]&&(n.action=r[o].slice(1,r[o].length).trim()),n}function E(t,e,n,r=Boolean){r(n)&&(t[e]=n)}function j(t,e,n){E(t,e,n,r=>r&&r.length>0)}function I(t){let e=p.exec(t),n=1,r=2;return e?{type:e[n],body:e[r]}:{type:"activity",body:t}}function P(t){return t.split(/\n\s*/g).map(e=>e.trim()).map(I)}export{T as a,y as b,x as c,d,b as e,S as f,A as g,E as h,j as i,P as j};
//# sourceMappingURL=chunk-34DTPQC7.js.map
